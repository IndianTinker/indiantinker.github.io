<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js">
</script>

  <meta name="google-site-verification" content="jnyuLnp8Zt_h8SKLdZzI_qRZ1uOO24uww8-ucfKDbJM" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="twitter:site" content="@rohit7gupta"/>
<meta name="twitter:creator" content="@rohit7gupta"/>
<meta name="twitter:card" content="summary_large_image"/>
<meta content="Rohit Gupta" property="og:site_name"/>


  <meta name="twitter:description" content="Regular Hacks, exploits, projects and tutorials by Rohit Gupta (IndianTinker)"/>


  <meta  property="og:title" content="Home"/>
  <meta name="twitter:title" content="Home"/>
  


  <meta property="og:type" content="article"/>
  <meta property="article:author" content="https://www.facebook.com/rohit7gupta" />


  <meta property="og:url" content="http://localhost:4000/page29/" />



  <meta content="https://farm4.staticflickr.com/3837/15112162250_f1720783c9.jpg" property="og:image"/>
  <meta name="twitter:image:src" content="https://farm4.staticflickr.com/3837/15112162250_f1720783c9.jpg"/>







  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Rohit Gupta &middot; Doer, Designer and Researcher
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
<link href="https://fonts.googleapis.com/css?family=Nunito|Roboto+Mono" rel="stylesheet"> 

  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

<!--Google Analytics-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55965373-1', 'auto');
  ga('send', 'pageview');

</script>
</head>


  <body>


    <div class="sidebar">
 </b>
  <div class="container sidebar-sticky">
<div align="center">
    <img src="/bitmoji.png" height="100px" width="100px" style="clip-path: circle(60px at center)">
</div>
    <div class="sidebar-about">
    <h1 color="#303F9F">
        <a href="/">
          Rohit Gupta
        </a>
      </h1>
      <p class="lead">A blog by <a href="https://twitter.com/rohit7gupta">@rohit7gupta</a></p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/archive/">Archive</a>
          
        
      
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/projects/">Projects</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/publications/">Research</a>
          
        
      
        
      
        
          
            <a class="sidebar-nav-item" href="/travels/">Writings</a>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      

   <!--
    <a class="twitter-follow-button"
  href="https://twitter.com/rohit7gupta"
  data-show-count="false"
  data-lang="en">
Follow @rohit7gupta
</a>
<script type="text/javascript">
window.twttr = (function (d, s, id) {
  var t, js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src= "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);
  return window.twttr || (t = { _e: [], ready: function (f) { t._e.push(f) } });
}(document, "script", "twitter-wjs"));
</script> -->
<br>

<!-- <p style="font-size:1.75rem ;color:#eceff1;">
<a class="list-group-item" href="https://www.twitter.com/rohit7gupta"><i class="fa fa-twitter"></i></a>
<a class="list-group-item" href="https://www.flickr.com/photos/94411929@N06/"><i class="fa fa-flickr"></i></a>
<a class="list-group-item" href="https://www.github.com/indiantinker"><i class="fa fa-github"></i></a>
</p>       

</span>-->
    </nav>
<p style="font-size:0.618rem ;color:black;">Made with <i class="fa fa-heart"></i> in India</a>
</p>

  </div>
</div>


    <div class="content container">
    <div class="post">
  
    </div>
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2014/11/09/Nokia5510-lcd-with-MSP430/">
        Nokia 5110 LCDs and MSP430
      </a>
    </h1>

    <span class="post-date">09 Nov 2014</span>

    <p>I had this Nokia LCD i picked up a while back. It is perfect when you want to play with graphics on a tiny lcd that comes from the good old days of Nokiaâ€™s Monochome days. Several might have spent days playing space invaders/snakes etc.</p>

<p>The time came when I was bored in my hotel room and I had it in my parts bin which i was carrying while moving from Delhi to Pune.</p>

<p>The LCD used a <a href="https://www.sparkfun.com/datasheets/LCD/Monochrome/Nokia5110.pdf">Phillips PCD 8544 Driver</a> which communicates on SPI.The voltage levels are <code class="highlighter-rouge">2.7-3.3V</code> happy for our MSP430.</p>

<p><em>NYC</em> has a pretty nice explanation on how it works and how to play with it with MSP430 over on his <a href="http://www.msp430launchpad.com/2012/08/using-nokia-lcd-library.html">blog</a></p>

<p>For TL:DR;</p>

<p>The LCD has the following pins to interface to:</p>
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
</style>

<table class="tg">
  <tr>
    <th class="tg-031e">Pin Number</th>
    <th class="tg-031e">Pin Label</th>
    <th class="tg-031e">Pin Function</th>
    <th class="tg-031e">Input/Output?</th>
    <th class="tg-031e">Notes</th>
  </tr>
  <tr>
    <td class="tg-031e">1</td>
    <td class="tg-031e">VCC</td>
    <td class="tg-031e">Positive power supply</td>
    <td class="tg-031e">Input</td>
    <td class="tg-031e">Supply range is between 2.7V and 3.3V</td>
  </tr>
  <tr>
    <td class="tg-031e">2</td>
    <td class="tg-031e">GND</td>
    <td class="tg-031e">Ground</td>
    <td class="tg-031e">Input</td>
    <td class="tg-031e"></td>
  </tr>
  <tr>
    <td class="tg-031e">3</td>
    <td class="tg-031e">SCE</td>
    <td class="tg-031e">Chip select</td>
    <td class="tg-031e">Input</td>
    <td class="tg-031e">Active low</td>
  </tr>
  <tr>
    <td class="tg-031e">4</td>
    <td class="tg-031e">RST</td>
    <td class="tg-031e">Reset</td>
    <td class="tg-031e">Input</td>
    <td class="tg-031e">Active low</td>
  </tr>
  <tr>
    <td class="tg-031e">5</td>
    <td class="tg-031e">D/C</td>
    <td class="tg-031e">Mode select</td>
    <td class="tg-031e">Input</td>
    <td class="tg-031e">Select between command mode (low) and data mode (high).</td>
  </tr>
  <tr>
    <td class="tg-031e">6</td>
    <td class="tg-031e">DN(MOSI)</td>
    <td class="tg-031e">Serial data in</td>
    <td class="tg-031e">Input</td>
    <td class="tg-031e"></td>
  </tr>
  <tr>
    <td class="tg-031e">7</td>
    <td class="tg-031e">SCLK</td>
    <td class="tg-031e">Serial clock</td>
    <td class="tg-031e">Input</td>
    <td class="tg-031e"></td>
  </tr>
  <tr>
    <td class="tg-031e">8</td>
    <td class="tg-031e">LED</td>
    <td class="tg-031e">LED backlight supply</td>
    <td class="tg-031e">Input</td>
    <td class="tg-031e">Maximum voltage supply is 3.3V.</td>
  </tr>
</table>

<p>The display is divided into 6 horizontal bands of 8 bits each (48) and 84 columns .</p>

<p>At a time you write to a single bank.</p>

<p>And you can continue to update only a single bank just in case you have dynamic data in that particular bank.</p>

<p>The communication is done using SPI.</p>

<p>The code that i used is based on <a href="http://forum.43oh.com/topic/1312-nokia-5110-display/">RobGâ€™s post</a>.</p>

<p>It displays the temperature (from the internal sensor ofcourse!) and some static text</p>

<p>Connections are as follows(PORT1):</p>

<ul>
  <li>LCD5110_SCLK_PIN- BIT5</li>
  <li>LCD5110_DN_PIN- BIT7</li>
  <li>LCD5110_SCE_PIN- BIT0</li>
  <li>LCD5110_DC_PIN- BIT1</li>
</ul>

<p><a href="https://www.flickr.com/photos/94411929@N06/15171730494" title="WP_20140803_19_27_04_Pro by Rohit Gupta, on Flickr"><img src="https://farm8.staticflickr.com/7583/15171730494_4b72e85970_z.jpg" width="640" height="372" alt="WP_20140803_19_27_04_Pro" /></a>
<br /></p>

<noscript><pre>400: Invalid request
</pre></noscript>
<script src="https://gist.github.com/72070b40befcf1417e2a.js"> </script>

<p><a href="https://www.flickr.com/photos/94411929@N06/14631629150" title="When u are #Bored in a #Hotel room, Its time to #play with new #Hardware #MSP430 #DIY #Pune by Rohit Gupta, on Flickr"><img src="https://farm6.staticflickr.com/5576/14631629150_4d33d536b4.jpg" width="500" height="500" alt="When u are #Bored in a #Hotel room, Its time to #play with new #Hardware #MSP430 #DIY #Pune" align="center" /></a></p>

<p>Just incase you need to play more with graphics see this cool post by <a href="https://learn.sparkfun.com/tutorials/graphic-lcd-hookup-guide">Sparkfun</a></p>

<p>If you have any difficulties post here in comments</p>
<a href="/2014/11/09/Nokia5510-lcd-with-MSP430/" style="text-align:right;">Read more&nbsp;<i class="fa fa-arrow-circle-right"></i></a>
<br>
<hr>
  </divr
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2014/11/03/Library-for-MMA7361/">
        Arduino Library for Freescale's MMA7361 3 axis accelerometer
      </a>
    </h1>

    <span class="post-date">03 Nov 2014</span>

    <p>Accelerometers huh! No new term these days! Every <strong>practical</strong> phone these days has one! Accelerometers churn out data in two ways :</p>

<ul>
  <li>Analog which can be directly read by our friendly ADC</li>
  <li>Digital which send data in values riding on I2C/SPI.</li>
</ul>

<p>The one that i had is an analog one and is probably the first one that comes when you search with keywords <em>Arduino Accelerometer</em> on ebay/AliExpress. It(module) is based on <a href="http://www.freescale.com/files/sensors/doc/data_sheet/MMA7361L.pdf">Freescale â€˜s MMA7361 analog 3Axis Accelerometer</a>.</p>

<p><img src="http://deadbugelectronics.com/image/cache/data/Sensor/Acc_Gyro/MMA7361%20-%201-500x500.jpg" alt="Image" /></p>

<p>I bought it a while back and was curious to play with it. The pin description (thanks to the simplification done <a href="http://eecs.oregonstate.edu/education/docs/accelerometer/MMA7361_module.pdf">here</a>) is as follows:</p>

<ul>
  <li><strong>X,Y,Z</strong> give Analog Voltage outputs based on the orientation</li>
  <li><strong>SL</strong> - Sleep (needs to be Pulled up)</li>
  <li><strong>0g</strong> - It gives a signal when 0g is detected.</li>
  <li><strong>5v,3v,GND</strong> - Usual Power Connections 3V is produced internally if 5v is applied</li>
  <li><strong>GS</strong> - Sensitivity select- the IC allows 1.5g and 6g settings</li>
  <li><strong>ST</strong> - Self Test</li>
</ul>

<p>Without doing the <strong>RTFD(D-Datasheet)</strong> i quickly plugged in the board to read X values and to derive any conclusion and Alas! it failed.I then went thru the datasheet to find out the IC is initially in <em>Sleep</em> Mode and has to be awaken by <em>pulling-Up</em> the Sleep pin.</p>

<p>Just connect a 10k resistor to the Sleep Pin and to the 3.3V output pin and now we have most of the circuit set up.</p>

<p><img src="https://farm6.staticflickr.com/5614/15071754173_00038d914a.jpg" alt="IMg" /></p>

<p>Now just:</p>

<ul>
  <li>read the analog values from the pin</li>
  <li>convert them to voltages</li>
  <li>apply sensitivity and correction</li>
  <li>and get g value</li>
</ul>

<p>Simple as that!</p>

<p>Having deciphered it, i wrote a test code:</p>

<noscript><pre>400: Invalid request
</pre></noscript>
<script src="https://gist.github.com/1d5402b9b3562345cc44.js"> </script>

<p>It worked as designed.</p>

<p>Then i thought that it will be better to try writing a library for it and learn how to write libraries in the process.
The process turned out to be easy thanks to the documentation by <strong>Arduino</strong>.</p>

<p>My Library can be found here on <a href="https://github.com/IndianTinker/MMA7361Library">github</a></p>

<p>Feel free to fork it and use it. 
Hoping the community finds it useful.</p>

<p>Cheers,</p>

<p>Rohit</p>
<a href="/2014/11/03/Library-for-MMA7361/" style="text-align:right;">Read more&nbsp;<i class="fa fa-arrow-circle-right"></i></a>
<br>
<hr>
  </divr
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2014/10/28/Dollar-LED-Bulb/">
        Inside a Cheap LED Bulb
      </a>
    </h1>

    <span class="post-date">28 Oct 2014</span>

    <p>I was recently on the visit to my hometown <em>Delhi</em> this Diwali when i visited <strong>Lajpat Rai</strong> market, the sweet spot every maker in Delhi knows/visits. There while glancing through the tiny crowded streets i found a shop selling nice pretentious LED Bulbs at a pretty cheap price of about a Dollar (60 INR). The LED intensity was evenly spread, flicker of any sort was absent and 7W was promised. I bought a couple and went back home to take them apart.</p>

<p>It was pretty clear that the Bulbs wont have those <em>Chinese</em> drivers that most Local Manufacturers use. They themselves cost around 20-25 INR and there is cost of LEDs, Metal PCB, Bulb casing and not to forget the labour. My next guess was it might contain those nicely tuned transformerless supplies that drain power across the resistor to get a lower voltage and the filter it to produce a not so clean DC Voltage.</p>

<p><a href="https://www.flickr.com/photos/94411929@N06/15646628781" title="WP_20141026_004 by Rohit Gupta, on Flickr"><img src="https://farm8.staticflickr.com/7507/15646628781_e2e377806e_z.jpg" width="359" height="640" alt="WP_20141026_004" align="center" /></a></p>

<p>And Bingo!
It did have a textbook transformerless design (<a href="4.bp.blogspot.com/-tOTZue-ocJc/T6H5mhgB1BI/AAAAAAAABPU/Ith1NLS, One can only gjnvg/s1600/transformerless+power+supply+circuit.png">like this</a>) on the PCB with almost no isolation except a small piece of cardboard and literally no regulation (<em>No Zener</em>)</p>

<p><a href="https://www.flickr.com/photos/94411929@N06/15012068084" title="#Inside a #OneDollar #LED #Bulb ! A Transformerless supply that is tuned to deliver correct V/I value. Quite Catastrophic in case of major #Fluctuations that we face in #Delhi. But what more can one expect for that price ! #MadeInIndia by Rohit Gupta, on Flickr"><img src="https://farm4.staticflickr.com/3935/15012068084_be8db3d3ca_n.jpg" width="320" height="320" alt="#Inside a #OneDollar #LED #Bulb ! A Transformerless supply that is tuned to deliver correct V/I value. Quite Catastrophic in case of major #Fluctuations that we face in #Delhi. But what more can one expect for that price ! #MadeInIndia" /></a></p>

<p>The entire Bulb had:</p>

<ul>
  <li>2x <code class="highlighter-rouge">470k</code> resistors,</li>
  <li>1 x <code class="highlighter-rouge">100uf</code> Electrolytic Capacitor,</li>
  <li>1 x <code class="highlighter-rouge">0.1uf</code>(guess) Capacitor with severed markings</li>
  <li>12 LEDs</li>
  <li>4 Diodes in bridge rectifier configuration.</li>
</ul>

<p><a href="https://www.flickr.com/photos/94411929@N06/15649322345" title="WP_20141026_003 by Rohit Gupta, on Flickr"><img src="https://farm6.staticflickr.com/5607/15649322345_a9bccfbe51.jpg" width="500" height="281" alt="WP_20141026_003" /></a></p>

<p>The bulb inspite of its circuit was quite bright and infact brighter than my quality 5W LED bulb.</p>

<p><a href="https://www.flickr.com/photos/94411929@N06/15028564094" title="WP_20141026_005 by Rohit Gupta, on Flickr"><img src="https://farm8.staticflickr.com/7494/15028564094_51bf7d42a9.jpg" width="281" height="500" alt="WP_20141026_005" /></a></p>

<p>One can only guess how long will this last, If the bulb faces the intense voltage fluctuations that Delhi Faces during summers , it will fail with no doubt. But still its great for the cost and the light it offers for whatever time it may do so.</p>

<p>Cheers!</p>

<p>Rohit</p>

<a href="/2014/10/28/Dollar-LED-Bulb/" style="text-align:right;">Read more&nbsp;<i class="fa fa-arrow-circle-right"></i></a>
<br>
<hr>
  </divr
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page30">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page28">Newer</a>
    
  
</div>

    </div>


  </body>
</html>
